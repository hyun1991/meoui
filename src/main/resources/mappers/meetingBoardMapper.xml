<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="MeetingBoardMapper">

	<!-- 1. 모임게시판 작성 -->

	<insert id="insertMeetingBoard" parameterType="MeetingBoard">
		<selectKey keyProperty="meetingboardNo" resultType="int"
			order="BEFORE">
			select meetingboard_seq.nextval from dual
		</selectKey>
	<![CDATA[
 	insert into meetingboard
	(meetingboard_no, meetingboard_title, meetingboard_content, 
	meetingboard_date, meetingboard_cnt, meetingboard_img, 
	member_no, meeting_no)
 	values(#{meetingboardNo},#{meetingboardTitle},#{meetingboardContent},
 	sysdate, #{meetingboardCnt}, #{meetingboardImg}, 
	#{memberNo}	, #{meetingNo})
]]>
	</insert>

	<!-- 게시판 리스트 출력 -->
	<select id="selectAllmeetinBoard" parameterType="HashMap"
		resultType="MeetingBoard">
		<![CDATA[
		select t2.*from(select rownum rnum, t1.* from
		(select meetingboard_no, meetingboard_title, meetingboard_content, meetingboard_date, 
		meetingboard_cnt, meetingboard_img, member_no, meeting_no 
		from MEETINGBOARD
		order by meetingboard_no desc)t1)t2 
		where meeting_no=#{meetingNo} and rnum
		between #{start} and #{last}
]]>
	</select>
	<!--  게시판 마지막 번호 -->
	<select id="meetingBoardCount" resultType="int">
		<![CDATA[select count(meetingboard_no) from meetingboard
		]]>
	</select>
	
	<!-- 게시판 상세 보기	 -->
	<select id = "selectMeetingBoardView" parameterType="int" resultType="MeetingBoard">
	<![CDATA[
		select b.meetingboard_title, b.meetingboard_content, b.meetingboard_date, b.meetingboard_cnt , b.meetingboard_img,  
		m.member_name from meetingboard b, member m where b.member_no= m.member_no and meetingboard_no=#{meetingboard_no}
	
	]]>
	
	</select>
	<!-- 번호로 삭제 -->
	<delete id="meetingBoardDelete" parameterType="int">
	<![CDATA[
	
	delete from meetingboard where meetingboard_no = #{meetingboardNo}
	
	]]>
		</delete>
	<!-- 번호로 삭제 관리자용-->
	<delete id="meetingBoardDeleteAdmin" parameterType="int">
	<![CDATA[
	
	delete from meetingboard where meeting_no = #{meetingNo}
	
	]]>
		</delete>	
		
		
	<!-- 수정 -->
	<update id="updateMeetingBoard" parameterType="MeetingBoard">
	<![CDATA[
	
		update member set member_password=#{memberPassword}, member_name=#{memberName}, member_phone=#{memberPhone}, member_address=#{memberAddress}, member_mail=#{memberMail}, member_job=#{memberJob},
			member_hobby=#{memberHobby} where member_id=#{memberId} and member_no=#{memberNo} 
	
	]]>
	
	</update>
	
	

	
	
</mapper>

